---

---

# 基础

![image-20240304212301044](C:\Users\hxd15\AppData\Roaming\Typora\typora-user-images\image-20240304212301044.png)

**打开mysql方式**

- **搜索命令提示符（cmd）**

'net start mysql80'

![image-20240304214959928](C:\Users\hxd15\AppData\Roaming\Typora\typora-user-images\image-20240304214959928.png)

通过全局跳到path环境变量再输入

和cmd有一些差别

命令提示符然后管理员运行

- 用cmd命令


![image-20240304215654473](C:\Users\hxd15\AppData\Roaming\Typora\typora-user-images\image-20240304215654473.png)

注意：环境变量配置是系统配置，然后变量名为path，设置成其他的都不管用

`mysql -u root -p`

-u接口、-p密码



**下载安装**

![image-20240305100857449](C:\Users\hxd15\Desktop\Repository\GithubRepository\MySQL_LearningNote\assets\image-20240305100857449.png)



mysql语言分类

![image-20240305101840442](C:\Users\hxd15\Desktop\Repository\GithubRepository\MySQL_LearningNote\assets\image-20240305101840442.png)



## DDL

### **数据库操作**

`查询`

```mysql
show databases;

select database();
```

`创建`

create database (if not exists) `test`;

create schema ……

`删除`

drop database (if exists) `test`;

`使用`

use `test`;



### **表操作**

- **查询**

show tables;

desc  `stuInfo`;

show create table `test`;	查询建表语句

- **创建**

```mysql
create table stuInfo(
	name varchar(10) comment '姓名',
	age int comment '年龄',
	sno varchar(15) comment '学号'
)comment '学生信息表'
```

- **修改**

添加字段

```mysql
-- 默认最后一排
alter table test add address varchar(20)
comment '地址';

-- 指定位置
alter table test add address varchar(20) after name;
alter table test add address varchar(20) first;
```

修改类型

```mysql
alter table test modify age varchar(3);
```

修改字段名和类型

```mysql
alter table test change address tel varchar(15) comment'电话号码';
```





删除字段

```mysql
alter table test drop tel;
```

修改表名

```mysql
alter table rename to stuInfo;
```

- 删除

删除表

```mysql
drop table (if exists) test;
```

删除指定表并重新创建该表

```mysql
truncate table test; # 数据全部丢失
```



移动字段

```mysql
-- 修改字段到第一列
alter table tb_emp modify Name varchar(25) FIRST;

-- 移动到某个字段后一列
alter table tb_emp modify DeptId int(11) AFTER Salary;

--语法规则为： ALTER TABLE 表名 MODIFY 字段1 数据类型 FIRST|AFTER 字段2; 。
```



删除表的外键约束

```mysql
alter table tb_emp drop foreign key emp_dept;
```



数据库名区分大小写





desc 描述

comment  v、评论，n、解释，评论









**字符串类型**

text blob char varchar

char（10)   最大长度 定长字符串 占用空间固定10 

varchar(10)  占用空间取决具体

性能上char高

varchar需要根据内容计算占用空间

**时间类型**

date

time





![image-20240305110406103](C:\Users\hxd15\AppData\Roaming\Typora\typora-user-images\image-20240305110406103.png)

```mysql
create table employee(
	id varchar(10) comment '编号',
	workno varchar(15) comment '员工工号',
	name varchar(10) comment '员工姓名',
	gender char(1) comment '性别',
	age tinyint unsigned comment '年龄',
	idcard char(18) comment '身份证',
	entrydate date comment '入职时间'
)comment '员工信息';
```

` ` `符号是转义符号避免关键字冲突











![image-20240305112946191](C:\Users\hxd15\AppData\Roaming\Typora\typora-user-images\image-20240305112946191.png)





## DML

### 添加数据

**指定数段添加数据**

```mysql
insert into employee(name,tel,address) values('张三','156789456','湖北武汉');
```

字符串，日期都要用‘ ’

- **添加数据**

```mysql
insert into employee values('张三','156789456','湖北武汉',18,'1');
```

- **批量添加数据**

```mysql
insert into employee (name, tel, address) values('张三', '789456' ,'湖北武汉'),('李四', '123456','北京');

insert into employee values('李四','8954612','北京', 19, '1'),('张三','156789456','湖北武汉',18,'2');
```

此处查询存储数据情况语句

```mysql
select * from employee;
```



---



### 修改数据

修改数据默认全修改，如果不加 

- 条件修改

```mysql
update employee set name = '李四' where id = 1;
```

- 全部修改

```mysql
update employee set entryDate = '2024-3-15';
```



---



### 删除数据

修改同理

- 条件删除

```mysql
delete from employee where gender = '女';
```

删除性别为女的信息

- 删除所有

```mysql
delete from employee;
```

删除数据至少为一行

如果需要删除某一个字段的值用update修改为NULL





















---



## DQL

### 基本语法

```mysql
SELECT
 字段列表
FROM
 表名列表
WHERE
 条件列表
GROUP BY
 分组字段列表
HAVING
 分组后条件列表
ORDER BY
 排序字段列表
LIMIT
 分页参数

```



### 基础查询

查询数据，起别名是查询出来的数据顶端有项目名字，方便查看

去除重复记录，查询的数据有重复的不显示

可以将查询进行组合

```mysql
select id,name from employee;

-- 全部查询，可以将字段全列出来
select * from employee;
select id,name,workno,workaddress … from employee;

-- 字段设置别名
SELECT 字段1 [ AS 别名1 ] , 字段2 [ AS 别名2 ] ... FROM 表名;
SELECT 字段1 [ 别名1 ] , 字段2 [ 别名2 ] ... FROM 表名;

select name as '姓名' from employee;

-- 去除重复
select distinct workaddress from employee;
```

正常查询结果如图，起别名后name会变成  姓名

![image-20240315150059861](C:\Users\hxd15\AppData\Roaming\Typora\typora-user-images\image-20240315150059861.png)



### 条件查询

`!=  <>`		不等于

between …… and ……    闭区间

in …… 取in中的某个字段

**like	_匹配单个字符串，%匹配任意字符串**

is null



and	&&

or		||

not		!

```mysql
-- like
-- 查询姓名为两个字符
select * from emp where name like '__';

-- 查询身份证号最后一位是x
select * from emp where name like '%x';
select * from emp where name like '_______________x';
```





### 聚合函数

```mysql
-- count sum
-- max min avg
```

NULL值不参与计算

```mysql
select count (*) from employee; -- 统计记录数

select count(idcard) from employee; -- 统计不能null的idcard数

select count(1) from employee;
```



统计西安地区工作人员年龄之和

```mysql
select sum(age) from employee where address = '西安';
```





### 分组查询

`group by    having  `

```mysql
-- 根据性别分组统计男性员工和女性员工数量
select count(*) from employee group by gender;

-- 根据性别分组统计男性员工和女性员工的平均年龄
select avg(age) from employee group by gender;

-- 查询年龄小于45的员工 , 并根据工作地址分组 , 获取员工数量大于等于3的工作地址

select workaddress,count(*) from employee where age<45 group by workaddress having count(*) >= 3;

-- 别名写法
select workaddress,count(*) [as] address_count from emp where age<45 group by workaddress having address_count >3;

-- 可省略

```



### 排序查询

`order by`



```mysql
-- asc 升序
-- desc 降序

-- 根据年龄对公司的员工进行升序排序
select * from emp order by age asc;
-- 根据入职时间, 对员工进行降序排序
select * from emp order by entrydate desc;

-- 根据年龄对公司的员工进行升序排序 , 年龄相同 , 再按照入职时间进行降序排序
select * from emp order by age asc,entrydate desc;
```



### 分页查询

`select * from emp limit ……`

`SELECT 字段列表 FROM 表名 LIMIT 起始索引, 查询记录数 ;`

```mysql
-- 查询第一页（索引为0）
select * from emp limit 0,5;
select * from emp limit 5;

-- 查询第二页数据，每页5个
select * from emp limit 5,5;

```





### 案例

```mysql
-- 统计员工表中, 年龄小于60岁的 , 男性员工和女性员工的人数

-- 查询所有年龄小于等于35岁员工的姓名和年龄，并对查询结果按年龄升序排序，如果年龄相同按
入职时间降序排序。
select name,age from emp where age<=35 order by age asc,entrydate desc;

-- 查询性别为男，且年龄在20-40 岁(含)以内的前5个员工信息，对查询的结果按年龄升序排序，
年龄相同按入职时间升序排序
select * from emp where age>=20 && age<=40 order by age asc,entrydate asc limit 0,5
```



### 执行顺序

![image-20240319090055182](C:\Users\hxd15\AppData\Roaming\Typora\typora-user-images\image-20240319090055182.png)



```mysql
select e.name ename , e.age eage from emp e where e.age > 15 order by eage asc;
```







---

## DCL

 查询用户

```mysql
use mysql;
select * from mysql.user;
```

创建用户

```mysql
create user 'itcast'@'主机名' identified by '密码';
```

修改用户密码

```mysql
alter user 'itcase'@'主机名'identified with mysql_native_password by '新密码';
-- 本地密码处理方式
```

删除用户

```mysql
drop user'用户名'@'主机名'
```

主机名可以用%来进行匹配，表示任意主机



**权限管理**

查询权限

```mysql
show grants for '用户名'@'主机';
```

授予权限

```mysql
grant 权限列表 on 数据库名.表名 to '用户名'@'主机'
```

撤销权限

```mysql
revoke 权限列表 on 数据库名.表名 from '用户名'@'主机'
```



## 函数

### 字符串函数

![image-20240319102655791](C:\Users\hxd15\AppData\Roaming\Typora\typora-user-images\image-20240319102655791.png)

```mysql
select CONCAT('hello',' ','world','!');

select LOWER('HELLO');
select UPPER('hello');

-- 字符串填充注意
select LPAD('str',5,'abc');
select RPAD('str',5,'abcdef');

select TRIM('  1231234sffda  ');

-- 截取字符串 索引是从1开始的
select SUBSTRING('123456abcdef',2,5);
```

![image-20240326101410919](C:\Users\hxd15\AppData\Roaming\Typora\typora-user-images\image-20240326101410919.png)



----



### 数值函数

![image-20240319102716959](C:\Users\hxd15\AppData\Roaming\Typora\typora-user-images\image-20240319102716959.png)

```mysql
select CEIL(1.3);
select FLOOR(1.3);
select MOD(5,2);
select RAND();
select ROUND(4.5893423,3);
```



---



### 日期函数

![image-20240326095816051](C:\Users\hxd15\AppData\Roaming\Typora\typora-user-images\image-20240326095816051.png)

```mysql
select CURDATE();	# 日期
select CURTIME(); 	# 时间
select NOW(); 		# 日期+时间

select YEAR(NOW());
select MONTH(NOW());
select DAY(NOW());

select DATE_ADD(NOW(),INTERVAL 20 YEAR);

# 前-后
select DATEDIFF('2023-3-26','2033-5-15');
```



---



### 流程函数

基本函数

![image-20240326102922208](C:\Users\hxd15\AppData\Roaming\Typora\typora-user-images\image-20240326102922208.png)

应用

```mysql
select IF(true,'ok','no');
select IF(false,'ok','no');

select IFNULL('not null','null');
select IFNULL(null,'null');
select IFNULL('','Default'); # 第一空非NULL

select name,
( CASE workaddress WHEN '北京' then '一线城市' WHEN '上海' then '一线城市' else '二线城市'end ) '工作地址'
from emp;

select id,name,
( CASE WHEN age>=20 && age<=30 then'年轻' WHEN age>30 then '中年' end )
from emp;
```



---



## 约束

![image-20240326104607136](C:\Users\hxd15\AppData\Roaming\Typora\typora-user-images\image-20240326104607136.png)

`AUTO_INCREMENT`每次添加数据自动加1，id等较多使用

```mysql
create table tb_user(
	id int primary key auto_increment, # 顺序可调
	name varchar(10) not null unique,
    age int check(age > 0 && age <= 120),
    status char(1) default '1',
    gender char(1)
);
```

![image-20240326160842217](C:\Users\hxd15\AppData\Roaming\Typora\typora-user-images\image-20240326160842217.png)



**外键约束**

![image-20240326161028937](C:\Users\hxd15\AppData\Roaming\Typora\typora-user-images\image-20240326161028937.png)

删除dept部门表，但是员工表对应的部门编号仍然存在，员工表对应的数据本应该也被删除，为了保证数据表的完整性，此时需添加外键约束

```mysql
# 表内添加外键
CREATE TABLE 表名(
 字段名 数据类型,
 ...
 [CONSTRAINT] [外键名称] FOREIGN KEY (外键字段名) REFERENCES 主表 (主表列名) 
);

# 表外添加外键
ALTER TABLE 表名 ADD CONSTRAINT 外键名称 FOREIGN KEY (外键字段名) 
REFERENCES 主表 (主表列名) ;
```



**外键案例**

```mysql
# 数据准备
create table dept(
 id int auto_increment comment 'ID' primary key,
 name varchar(50) not null comment '部门名称'
)comment '部门表';

INSERT INTO dept (id, name) VALUES (1, '研发部'), (2, '市场部'),(3, '财务部'), (4, 
'销售部'), (5, '总经办');

create table dept_emp(
 id int auto_increment comment 'ID' primary key,
 name varchar(50) not null comment '姓名',
 age int comment '年龄',
 job varchar(20) comment '职位',
 salary int comment '薪资',
 entrydate date comment '入职时间',
 managerid int comment '直属领导ID',
 dept_id int comment '部门ID'
)comment '员工表';

INSERT INTO dept_emp (id, name, age, job,salary, entrydate, managerid, dept_id) 
VALUES
 (1, '金庸', 66, '总裁',20000, '2000-01-01', null,5),
 (2, '张无忌', 20, '项目经理',12500, '2005-12-05', 1,1),
 (3, '杨逍', 33, '开发', 8400,'2000-11-03', 2,1),
 (4, '韦一笑', 48, '开发',11000, '2002-02-05', 2,1),
 (5, '常遇春', 43, '开发',10500, '2004-09-07', 3,1),(6, '小昭', 19, '程序员鼓励师',6600, '2004-10-12', 2,1);

```

```Mysql
# 给员工表添加部门外键
alter table dept_emp add constraint fk_dept_emp_dept_id foreign key (dept_id) references dept(id);
```



添加外键后，删除父表会产生约束，删除子表没事

![image-20240326194210427](C:\Users\hxd15\AppData\Roaming\Typora\typora-user-images\image-20240326194210427.png)



**删除外键**

```mysql
ALTER TABLE 表名 DROP FOREIGN KEY 外键名称;
```

删除/更新 父表 

![image-20240326195135306](C:\Users\hxd15\AppData\Roaming\Typora\typora-user-images\image-20240326195135306.png)



```mysql
# 用法
ALTER TABLE 表名 ADD CONSTRAINT 外键名称 FOREIGN KEY (外键字段) REFERENCES 主表名 (主表字段名) ON UPDATE CASCADE ON DELETE CASCADE;

alter table emp add constraint fk_emp_dept_id foreign key (dept_id) references dept(id) on update set null on delete set null ;
```





---

## 多表查询

 
